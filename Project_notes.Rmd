---
title: "Notes on project"
output:
  word_document: default
  html_notebook: default
editor_options:
  chunk_output_type: inline
---

10/14/2023

Agreagar lat and log to the bat2021_v2 database.

Then, the predictors matrix for the population analysis section is calculated.

------------------------------------------------------------------------

10/15/2023

I tried copying the lat and log but there seems to be a problem as points are not plotting correctly. There might be problems with the coordinates. Update: I tried again and the elevatr package loaded and worked. However, I didn't display any elevation.\
I tried the package raster and plotted the DEM for Idaho and was able to obtain elevation for each site.

\
For the population analysis I want to include moon phase, moon illumination, elevation, riparian veg.

The riparian vegetation I will calculate with the NDVI. Unfortunately, is not working as it is. I am using  a code that is in the cleanup script. ChatGPT helped me generate it, but still not working well.

11/17/2023

Per recommendation of Jen I created the matrix lano_js that should be use to run the model in the script pop_model. We will be using just a single species data set for testing right now. To the file lano_js we remove last week and the site column. We also made 0 data because we didn't wanted.

I just noticed that when I write a file with the write.csv function there's a there's a new index column created that has a number for each row. How to prevent this?

write.csv(iris, file = "iris.csv", row.names = FALSE)

you have to set the row.names=false argument.

11/20/2023\
I ran the data work but got an error anyway.

```{r}
urn-in + Update 1 (30000)Error in checkForRemoteErrors(val) :

  5 nodes produced errors; first error:

Error parsing model file:

syntax error on line 44 near "}"
```

I think there's something wrong with the model when we feed it to JAGS.

we fixed this.

11/29/2023

I talked to Jen Cruz, and she mentioned I have to be careful with the things that I include in the GitHub. For example, I should not trace the R project where I am working. I should just use trace the changes in the scripts. According to her tracing the project could break cause trouble in the future.  

------------------------------------------------------------------------

12/4/2023

-   I worked on the bat_pop_analysis.R script. I have organized the Lano, slc, and obs. cov, so they have no site column, and they are arranged in ascending order of week.

-   I created this R mark notebook to take notes of the thing here instead of a Word document.

-   Created obs.cov2 for moon. illumination

------------------------------------------------------------------------

12/05/2023

-   started building the plotting code. got a margina plot for elevation but not for light or dark.

-   need to calculate weather variables.

-   need to calculate NDVI

-   I meet with Jen she mentioned that the models did not converged so I increase the max number of iterations to one million. the results still not converged...

------------------------------------------------------------------------

12/06/2023

-   I need to build the weather data base to run the pop models.
-   Problems with the model :\
    ![m1 diag plot](figures/m1_diag_plot.png){width="848"}

-There are several peaks for density plot. This means there's problems with identifiability because there are multiple plots in the posterior?\
-the chains are not in the same space. This means they are getting stuck in the same spot right?

When I increased to two million the Rhat values decreased? does this mean we are approaching convergence?

------------------------------------------------------------------------

12/19/2023

meeting with Jen:

-   The model is still not converging. We change the random intercept for abundance from site to week. It seems there is great variability in bat activity between weeks (see lano_js.csv). One solution might be to select certain weeks to be the ones that we analyze. Another solution is to add an extra level to the model to account for availability.

------------------------------------------------------------------------

12/21/2023

-   I ran into a problem with the data from 2021 for bats. The raw data produced with the script build data base v3 and v4. Currently the 2021 data has only 13 sites. It should be 14 because one site is missing entirely from the data base. I intended to update the data base with new code to get all the data points. Unfortunately it seems I am not collecting all the output files from Sonobat (Data_CumulativeSonoBatch_v420). I am in the process of compiling them but making a list of all the txt files using the function list.files() take a long time. So I am using the function dir_ls() from the fs package.

------------------------------------------------------------------------

01/23/2023

In the code build_data_base_v4 I was able to see what what happening with the bat 2021 data. - some files have not been analyzed with sonobat and are missing from the database - once all the .txt files in the 2021 folder are compiled, there are two ways of getting the data out.\
- sonofiles1\<- sm3dirs[grepl("\_CumulativeSonoBatch_v420.txt", sm3dirs)] - sonofiles2\<- sm3dirs[grepl("SonoBatch_v420.txt", sm3dirs)] \# this one doubles the data as it also get all the cumulativesonobatch files. I will be using the first one.

-   Also, we need to start using the column marked as 1st for species present in the recordings. This provides us with more data to work with compared to just the SpAccp column.

------------------------------------------------------------------------

1/25/2024

I am still running Sonobat on some 2021 data and it needs to be run in all 2023 part b data.

I will start building the 2022 database for bats.

-   I need to check what days were for each site. I need to check what dates where sampled for insects with bucket traps.

-   I need to check the variation of bat calls per species by week

------------------------------------------------------------------------

1/29/2023

-   I created bat2022_v2. It has the species and the dates. we need to calculate the moon.

-   I also realized that I should calculate the date for the raw data. That way, I could know how many hours each recording was working.

-   **IMPORTANT**: the batraw2022 database has data for iron 1 to 6. We need to fix this one too.

    ------------------------------------------------------------------------

1/30/2023

-   I will fix the issue with the batraw2022 data, so we have the data for all the sites. One possible issue is that we need to run more sites with Sonobat.

-   I also realize I need to check some call data data to corroborate these are properly ID correctly.

-   I can run some Sonobat data through kaleidoscope to see how these compare.

------------------------------------------------------------------------

1/31/2024

-   I updated the code for the 2021 data but and I believe not all audio files have been ran trough Sonobat.

    ------------------------------------------------------------------------

02/13/2024

After these two weeks I realized that for 2021 we have two sites failed (long02, and Viz4).\
It also seems like the old table fro 2021 data had lots more data and I don't know why. It might be possible that we merged tables we didn't wanted.

Next step check the updated table and ask. How many files there are and how many nights of data we have for each site. It could be possible not all sm3 were on at all time.\

------------------------------------------------------------------------

Ok I think the Sonobat files made with v420 and v4.4.5 once they are merged the columns might not align and might mes up the merging of files and thus creating a full data file.

solution: proceed as for now and continue running all the files through sonobat to run them all using just sonobat v4.4.5

I am working with the cleanup_script_v2 to be able to check the data and see what sites have data and how many data points we have. I will also include the from two columns the sppaccp and the \~spp. this way we will increase the data we have.
